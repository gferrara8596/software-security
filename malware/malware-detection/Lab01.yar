/*
   YARA Rule Set
   Author: yarGen Rule Generator
   Date: 2022-04-28
   Identifier: Chapter_1L
   Reference: https://github.com/Neo23x0/yarGen
*/

/* Rule Set ----------------------------------------------------------------- */

rule Lab01_01 {
   meta:
      description = "Chapter_1L - file Lab01-01.dll"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2022-04-28"
      hash1 = "f50e42c8dfaab649bde0398867e930b86c2a599e8db83b8260393082268f2dba"
   strings:
      $s1 = "SADFHUHF" fullword ascii
      $s2 = "127.26.152.13" fullword ascii
      $s3 = "/0I0[0h0p0" fullword ascii
      $s4 = "141G1[1l1" fullword ascii
      $s5 = "1Y2a2g2r2" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 500KB and
      all of them
}

rule Lab01_01_2 {
   meta:
      description = "Chapter_1L - file Lab01-01.exe"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2022-04-28"
      hash1 = "58898bd42c5bd3bf9b1389f0eee5b39cd59180e8370eb9ea838a0b327bd6fe47"
   strings:
      $x1 = "C:\\windows\\system32\\kerne132.dll" fullword ascii
      $x2 = "C:\\Windows\\System32\\Kernel32.dll" fullword ascii
      $s3 = "kerne132.dll" fullword ascii
      $s4 = "Lab01-01.dll" fullword ascii
      $s5 = "Kernel32." fullword ascii
      $s6 = "WARNING_THIS_WILL_DESTROY_YOUR_MACHINE" fullword ascii
      $s7 = "ugh 0@" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 50KB and
      1 of ($x*) and all of them
}

rule Lab01_04 {
   meta:
      description = "Chapter_1L - file Lab01-04.exe"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2022-04-28"
      hash1 = "0fa1498340fca6c562cfa389ad3e93395f44c72fd128d7ba08579a69aaf3b126"
   strings:
      $s1 = "\\system32\\wupdmgr.exe" fullword ascii
      $s2 = "\\system32\\wupdmgrd.exe" fullword ascii
      $s3 = "http://www.practicalmalwareanalysis.com/updater.exe" fullword ascii
      $s4 = "\\winup.exe" fullword ascii
      $s5 = "SeDebugPrivilege" fullword ascii /* Goodware String - occured 141 times */
      $s6 = "<not real>" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 100KB and
      all of them
}

/* Super Rules ------------------------------------------------------------- */

